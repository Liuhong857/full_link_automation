<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>detail_page</title>
    <link rel="stylesheet" href="/static/commons.css">
</head>
<body class="backgroud_image">
    <div  style="margin: 38px 0px;height: 58px;width: 100%">
        <h1 style="color: orange;text-align: center;line-height: 58px">
            <a style="text-decoration: none;color: orange;" href="/page/login/">橙联自动化平台</a>
        </h1>
    </div>
    <h2>API修改：</h2>
    <form action="/page/main/modify/" method="post" onsubmit="return modify(this)">
        {% for row in detail %}
            <div style="width: 80%;display:flex;margin-bottom: 5px;">

                <div style="display:flex;justify-content: center;align-items: center;">
                    <div style="width:100px;text-align: center">url: </div>
                        <input id="u1" style="height: 38px;width: 400px;"  type="text" name="api_url" value="{{ row.api_url }}">
                    </div>
                <div style="display:flex;justify-content: center;align-items: center;margin-left: 20px;">
                            <div style="width:100px;text-align: center">header:</div>
                            <input id="h1" style="height: 38px;width:400px ;" type="text" name="api_header" value="{{ row.api_header }}">
                </div>
            </div>
            <span id="url_error" style="color: red;margin-left: 240px;margin-bottom: 10px"></span>
            <span id="api_header_error" style="color: red;margin-left: 370px"></span>

            <div style="width: 80%;display:flex;margin-bottom: 20px;">
                <div  style="display:flex;justify-content: center;align-items: center;">
                    <div style="width:100px;text-align: center">method:</div>
                    <input id="m1" style="height: 38px;width: 400px;" type="text" name="api_method" value="{{ row.api_method }}">
                </div>
                <div  style="display:flex;justify-content: center;align-items: center;margin-left: 20px;">
                    <div style="width:100px;text-align: center">接口名称:</div>
                    <input id="n1" style="height: 38px;width: 400px;" type="text" name="api_name" value="{{ row.api_name }}">
{#                    <textarea style="height: 38px;width: 400px;line-height: 38px;"name="api_name">{{ row.api_name }}</textarea>#}
                </div>


            </div>
            <span id="api_method_error" style="color: red;margin-left: 240px;margin-bottom: 10px"></span>
            <span id="api_name_error" style="color: red;margin-left: 370px"></span>

            <div style="width: 80%;display:flex;margin-top: 20px;margin-bottom: 20px;">
                <div  style="display:flex;justify-content: center;align-items: center;">
                    <div style="width:100px;text-align: center" >data:</div>
{#                    <input style="height: 200px;width: 400px;" type="text" name="api_data" value="{{ row.api_data }}">#}
                    <textarea id="d1" style="height: 200px;width: 400px;" name="api_data">{{ row.api_data }}</textarea>

                </div>
                <div style="display:flex;justify-content: center;align-items: center;margin-left: 20px;">
                    <div style="width:100px;text-align: center">response:</div>
{#                    <input style="height: 200px;width: 400px;" type="text" value="{{ row.api_response }}">#}
                    <textarea id="r1" style="height: 200px;width: 400px;text-align: center">{{ row.api_response }}</textarea>
                </div>
            </div>
            <span id="api_data_error" style="color: red;margin-left: 240px;margin-bottom: 10px;"></span>
            <input type="text" style="display: none" name="id" value="{{ row.id }}">

        {% endfor %}
        <div>
            <a href="/page/main/select/" ><input type="button" value="返回"></a>
            <input type="submit" value="提交">
        </div>
    </form>









    <script src="/static/jquery.js"></script>

    <script>

        function modify(formvalue) {
            {#var url = $("#u1").val();#}
            var url = formvalue.api_url.value;
            var header = formvalue.api_header.value;
            var method = formvalue.api_method.value;
            var name = formvalue.api_name.value;
            var data = formvalue.api_data.value;


            {#var url_error= $("#url_error");#}
            var url_error_add = document.getElementById("url_error");
            var api_header_e = document.getElementById("api_header_error");
            var api_method_e = document.getElementById("api_method_error");
            var api_name_e = document.getElementById("api_name_error");
            var api_data_e = document.getElementById("api_data_error");


            var isSubmit= true;
            if(url==""){
                isSubmit= false;
                url_error_add.innerHTML = "URL不能为空！"
            }
            if(header==""){
                isSubmit= false;
                api_header_e.innerHTML = "header不能为空！"
            }
            if(method==""){
                isSubmit= false;
                api_method_e.innerHTML = "method不能为空！"
            }
            if(name==""){
                isSubmit= false;
                api_name_e.innerHTML = "api名称不能为空！"
            }
            if(data==""){
                isSubmit= false;
                api_data_e.innerHTML = "data不能为空！"
            }

            if(!isSubmit){
                //阻止表单提交
                return false;
            }
        }


    </script>
</body>
</html>